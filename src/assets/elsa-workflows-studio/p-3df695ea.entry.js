import{r as e,h as s}from"./p-d44d1ddb.js";import{c as a}from"./p-a3b5bd35.js";import{e as l}from"./p-d17a08e5.js";import"./p-25ed19bb.js";import{E as t}from"./p-f90ae5bc.js";import{a as r}from"./p-bdae1cb5.js";import"./p-4bdcf3f8.js";import{T as i}from"./p-151ebb97.js";import"./p-80de33dc.js";import"./p-e47f7c7d.js";import"./p-83f217d4.js";const o=class{constructor(s){e(this,s),this.workflowBlueprints={items:[],page:1,pageSize:50,totalCount:0},this.workflowRegistryColumns={data:null}}async componentWillLoad(){await this.loadWorkflowBlueprints(),await l.emit(t.WorkflowRegistryLoadingColumns,this,this.workflowRegistryColumns)}connectedCallback(){l.on(t.WorkflowUpdated,this.onLoadWorkflowBlueprints),l.on(t.WorkflowRegistryUpdated,this.onLoadWorkflowBlueprints)}disconnectedCallback(){l.detach(t.WorkflowUpdated,this.onLoadWorkflowBlueprints),l.detach(t.WorkflowRegistryUpdated,this.onLoadWorkflowBlueprints)}async onDisableWorkflowClick(e,s){await this.confirmDialog.show("Disable Workflow","Are you sure you wish to disable this workflow?")&&await this.updateFeature(s,"disabled","true")}async onEnableWorkflowClick(e,s){await this.confirmDialog.show("Enable Workflow","Are you sure you wish to enable this workflow?")&&await this.updateFeature(s,"disabled","false")}async updateFeature(e,s,a){const r={params:[e,s,a]};await l.emit(t.WorkflowRegistryUpdating,this,r)}async onLoadWorkflowBlueprints(){await this.loadWorkflowBlueprints()}async loadWorkflowBlueprints(){const e=await this.createClient();this.workflowBlueprints=await e.workflowRegistryApi.list(0,50,{allVersions:!0})}createClient(){return r(this.serverUrl)}render(){const e=a.groupBy(this.workflowBlueprints.items,"id"),l=this.basePath;let t=null!=this.workflowRegistryColumns.data?this.workflowRegistryColumns.data.headers:[],r=null!=this.workflowRegistryColumns.data&&this.workflowRegistryColumns.data.hasContextItems;const i=(e,a,l,t,i,o,n)=>{let d=[];return d=[...d,{text:"Edit",anchorUrl:t,icon:i}],r&&(d=a?[...d,{text:"Enable",clickHandler:s=>this.onEnableWorkflowClick(s,e),icon:o}]:[...d,{text:"Disable",clickHandler:s=>this.onDisableWorkflowClick(s,e),icon:n}]),s("td",{class:"elsa-pr-6"},s("elsa-context-menu",{history:l,menuItems:d}))};return s("div",null,s("div",{class:"elsa-align-middle elsa-inline-block elsa-min-w-full elsa-border-b elsa-border-gray-200"},s("table",{class:"elsa-min-w-full"},s("thead",null,s("tr",{class:"elsa-border-t elsa-border-gray-200"},s("th",{class:"elsa-px-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-left elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-text-left elsa-uppercase elsa-tracking-wider"},s("span",{class:"lg:elsa-pl-2"},"Name")),s("th",{class:"elsa-px-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-left elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-text-left elsa-uppercase elsa-tracking-wider"},"Instances"),s("th",{class:"hidden md:elsa-table-cell elsa-px-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-text-right elsa-uppercase elsa-tracking-wider"},"Latest Version"),s("th",{class:"hidden md:elsa-table-cell elsa-px-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-text-right elsa-uppercase elsa-tracking-wider"},"Published Version"),t.map((e=>(e=>s("th",{class:"hidden md:elsa-table-cell elsa-px-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-text-right elsa-uppercase elsa-tracking-wider"},e[0]))(e))),s("th",{class:"elsa-pr-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-text-left elsa-uppercase elsa-tracking-wider"}))),s("tbody",{class:"elsa-bg-white elsa-divide-y elsa-divide-gray-100"},a.map(e,(e=>{const r=a.orderBy(e,"version","desc"),o=r[0],n=o.version,d=r.find((e=>e.isPublished)),c=d?d.version:"-";let h=o.displayName;h&&0!=h.trim().length||(h=o.name),h&&0!=h.trim().length||(h="Untitled");const p=`${l}/workflow-registry/${o.id}`,g=`${l}/workflow-instances?workflow=${o.id}`,x=s("svg",{class:"elsa-h-5 elsa-w-5 elsa-text-gray-500",width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},s("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),s("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})),b=s("svg",{class:"elsa-h-5 elsa-w-5 elsa-text-gray-500",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},s("path",{stroke:"none",d:"M0 0h24v24H0z"}),s("path",{d:"M5 12l5 5l10 -10"})),w=s("svg",{class:"elsa-h-5 elsa-w-5 elsa-text-gray-500",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},s("path",{stroke:"none",d:"M0 0h24v24H0z"}),s("circle",{cx:"12",cy:"12",r:"9"}),s("line",{x1:"5.7",y1:"5.7",x2:"18.3",y2:"18.3"}));return s("tr",null,s("td",{class:"elsa-px-6 elsa-py-3 elsa-whitespace-no-wrap elsa-text-sm elsa-leading-5 elsa-font-medium elsa-text-gray-900"},s("div",{class:"elsa-flex elsa-items-center elsa-space-x-3 lg:elsa-pl-2"},s("stencil-route-link",{url:p,anchorClass:"elsa-truncate hover:elsa-text-gray-600"},s("span",null,h)))),s("td",{class:"elsa-px-6 elsa-py-3 elsa-text-sm elsa-leading-5 elsa-text-gray-500 elsa-font-medium"},s("div",{class:"elsa-flex elsa-items-center elsa-space-x-3 lg:elsa-pl-2"},s("stencil-route-link",{url:g,anchorClass:"elsa-truncate hover:elsa-text-gray-600"},"Instances"))),s("td",{class:"hidden md:elsa-table-cell elsa-px-6 elsa-py-3 elsa-whitespace-no-wrap elsa-text-sm elsa-leading-5 elsa-text-gray-500 elsa-text-right"},n),s("td",{class:"hidden md:elsa-table-cell elsa-px-6 elsa-py-3 elsa-whitespace-no-wrap elsa-text-sm elsa-leading-5 elsa-text-gray-500 elsa-text-right"},c),t.map((()=>s("td",{class:"hidden md:elsa-table-cell elsa-px-6 elsa-py-3 elsa-whitespace-no-wrap elsa-text-sm elsa-leading-5 elsa-text-gray-500 elsa-text-right"},o.isDisabled?"No":"Yes"))),i(o.id,o.isDisabled,this.history,p,x,b,w))}))))),s("elsa-confirm-dialog",{ref:e=>this.confirmDialog=e}))}};i.injectProps(o,["serverUrl","culture","basePath"]);export{o as elsa_workflow_registry_list_screen}